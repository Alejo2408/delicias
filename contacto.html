<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="contacto.css">
    <title>Contacto - Pastelería Deliciosa</title>
</head>
<body>

    <div class="Pasteles Deliciosos-ima">
        <img src="Imagenes/pngtree-d-render-of-colorful-cupcakes-cascading-on-a-minimalist-light-background-image_3857847.jpg" width="1400px" height="300px" alt="">

    </div>


    <header>
        <h1>Contacto</h1>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">Inicio</a></li>
            <li><a href="productos.html">Productos</a></li>
            <li><a href="contacto.html">Contacto</a></li>
        </ul>
    </nav>

    <section id="informacion">
        <p>Puedes contactarnos a través de WhatsApp para cualquier consulta:</p>
        <a href="https://web.whatsapp.com/send/?phone=1531581450&app_absent=0" target="_blank" class="whatsapp-button">Abrir WhatsApp Web</a>
    </section>

  <div id="comments-container">
        <!-- Aquí se mostrarán los comentarios -->
    </div>

    <div id="comment-form">
        <textarea id="comment-text" placeholder="Escribe tu comentario"></textarea>
        <button onclick="addComment()">Añadir Comentario</button>
    </div>

    <script src="https://gist.github.com/Alejo2408/907a6b4f90af4dcf9adeaf642b16536a.js"></script>
    <script src="script.js"></script>

    <script>
        // Función para cargar y mostrar comentarios desde el Gist
        function loadCommentsFromGist() {
            // Obtener la variable `gistData` que contiene el contenido del Gist
            var gistData = (typeof gistData !== 'undefined') ? gistData : {};

            // Obtener los comentarios del archivo JSON
            var comments = gistData.files['comments.json'].content;

            // Convertir el contenido JSON a un objeto JavaScript
            var commentsObj = JSON.parse(comments);

            // Mostrar los comentarios en la página
            var commentsContainer = document.getElementById("comments-container");
            commentsContainer.innerHTML = "";
            
            for (var i = 0; i < commentsObj.length; i++) {
                var commentDiv = document.createElement("div");
                commentDiv.textContent = commentsObj[i];
                commentsContainer.appendChild(commentDiv);
            }
        }

        // Llamar a la función para cargar y mostrar comentarios al cargar la página
        loadCommentsFromGist();

        // Función para agregar un comentario al Gist
        function addComment() {
            // Obtener el texto del comentario
            var commentText = document.getElementById("comment-text").value;

            // Validar que el comentario no esté vacío
            if (commentText.trim() === "") {
                alert("Por favor, escribe un comentario antes de enviar.");
                return;
            }

            // Obtener los comentarios almacenados en GitHub Gists
            var gistData = (typeof gistData !== 'undefined') ? gistData : {};

            // Obtener el token de acceso personal de GitHub
            var githubToken = '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';

            // Obtener los comentarios actuales del archivo JSON
            var comments = gistData.files['comments.json'].content;
            var commentsObj = JSON.parse(comments);

            // Agregar el nuevo comentario al objeto de comentarios
            commentsObj.push(commentText);

            // Convertir el objeto de comentarios a formato JSON
            var updatedComments = JSON.stringify(commentsObj);

            // Actualizar el contenido del archivo JSON en GitHub Gists utilizando la API de GitHub
            fetch(`https://api.github.com/gists/${gistData.id}`, {
                method: 'PATCH',
                headers: {
                    'Authorization': `Bearer ${githubToken}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    files: {
                        'comments.json': {
                            content: updatedComments
                        }
                    }
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Comentario agregado con éxito:', data);
                
                // Limpiar el cuadro de comentarios
                document.getElementById("comment-text").value = "";
                
                // Volver a cargar los comentarios para actualizar la página
                loadCommentsFromGist();
            })
            .catch(error => console.error('Error al agregar el comentario:', error));
        }
    </script>
    <footer>
        <p>&copy; 2023 Pastelería Deliciosa. Todos los derechos reservados.</p>
    </footer>
</body>
</html>
